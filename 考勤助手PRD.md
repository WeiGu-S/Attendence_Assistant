好的，根据您提供的图片描述和需求，我将为您输出一份详细的Python可视化桌面程序的产品需求文档（PRD）。

---

## **Python考勤图片解析可视化桌面程序PRD**

### **1. 项目概述**

#### **1.1. 项目名称**
考勤助手（Attendance Assistant）

#### **1.2. 项目背景**
用户需要一种高效、自动化的方式来处理每月以固定格式图片形式存在的考勤记录。手动整理耗时且易出错，本项目旨在开发一个桌面应用程序，通过OCR（光学字符识别）技术自动解析图片中的考勤信息，并进行可视化展示与导出。

#### **1.3. 项目目标**
开发一个基于Python的跨平台桌面应用程序，实现以下核心目标：
1.  **解析自动化**：用户上传图片后，程序自动识别图片中的日期、打卡状态（正常/异常）、上下班时间等信息。
2.  **数据可视化**：将解析后的数据以清晰、直观的日历形式展示给用户。
3.  **数据可导出**：允许用户将整理后的考勤数据导出为标准格式（如CSV、Excel），便于存档或进一步处理。

#### **1.4. 目标用户**
需要每月手动整理考勤记录的员工、HR或团队管理者。

---

### **2. 功能需求**

#### **2.1. 核心功能模块**

**模块一：图片上传与解析**
-   **功能点F1.1：支持图片上传**
    -   提供图形化按钮，支持用户通过拖拽或点击选择文件的方式上传`JPG`, `PNG`等常见格式的考勤图片。
-   **功能点F1.2：图像预处理**
    -   对上传的图片进行自动预处理，包括灰度化、二值化、降噪等，以提高OCR识别准确率。
-   **功能点F1.3：OCR文字识别**
    -   集成OCR引擎（如PaddleOCR、Tesseract），准确识别图片中的文字内容，特别是日期和时间。
-   **功能点F1.4：图案识别**
    -   识别图片中的绿色圆点（正常打卡）和灰色圆点（异常打卡）的位置，并将其与对应的日期单元格关联。
-   **功能点F1.5：数据结构化**
    -   将识别出的文本和图案信息进行解析、清洗和关联，整合成结构化的JSON或Python字典数据。
    -   示例结构：
        ```json
        {
          "year_month": "2025-09",
          "data": [
            {
              "date": "2025-09-01",
              "day_of_week": "周一",
              "type": "工作日",
              "clock_in": {"time": "09:00", "status": "正常"}, // 状态：正常、异常、未打卡
              "clock_out": {"time": "18:00", "status": "正常"}
            },
            // ... 其他日期数据
          ]
        }
        ```

**模块二：考勤数据可视化与交互**
-   **功能点F2.1：日历视图展示**
    -   以月历形式展示解析后的数据。
    -   每个日期格子中清晰显示：日期、星期几、上下班打卡时间。
    -   使用颜色直观表示打卡状态：绿色（正常）、灰色（异常已确认）、红色（异常未确认）、无色（未打卡/休息日）。
-   **功能点F2.2：状态图例**
    -   在界面一侧提供图例，说明各种颜色和状态的含义。
-   **功能点F2.3：数据校验与手动修正**
    -   提供简单界面让用户快速浏览识别结果。
    -   对于OCR可能识别错误的日期或时间，允许用户直接点击数据进行手动编辑修正。
    -   对于程序无法确定的异常状态，允许用户手动点击确认（例如，将红色异常状态标记为已确认的灰色）。

**模块三：数据导出与报表**
-   **功能点F3.1：导出为CSV/Excel**
    -   提供按钮，将整理好的整月考勤数据导出为CSV或Excel文件。
    -   导出文件应包含：日期、星期、类型、上班时间、下班时间、状态统计等列。
-   **功能点F3.2：统计信息显示**
    -   在界面中显示本月的基本统计信息，如：应出勤天数、实际出勤天数、正常打卡次数、异常次数等。

#### **2.2. 辅助功能模块**
-   **月份切换**：模拟原图功能，允许用户切换查看不同月份的考勤数据（需有对应图片）。
-   **设置**：允许用户进行简单配置，如选择OCR引擎路径、设置导出文件默认路径等。

---

### **3. 非功能需求**

-   **性能需求**：单张图片解析时间应控制在10秒以内。
-   **准确性需求**：在图片清晰、格式规范的前提下，关键信息（日期、时间）的识别准确率应高于98%。
-   **易用性需求**：界面简洁直观，符合原图布局风格，用户无需阅读复杂文档即可上手使用。
-   **兼容性需求**：支持Windows、macOS主流操作系统。
-   **可靠性需求**：程序需具备一定的容错能力，如处理模糊图片、非标准格式图片时应有明确的错误提示，而非直接崩溃。

---

### **4. 技术栈建议**

-   **GUI框架**：`PyQt5` 或 `Tkinter`。`PyQt5`UI更美观，功能更强大，推荐使用。
-   **OCR引擎**：`PaddleOCR`（推荐，中文识别准确率高，易于集成）或 `Tesseract`。
-   **图像处理**：`OpenCV-Python`（用于图像预处理、圆点检测和定位）。
-   **数据处理**：`Pandas`（用于数据清洗、结构化和导出Excel）。
-   **可视化组件**：可使用`Qt`自带的`QTableWidget`或`QCalendarWidget`定制绘制月历视图。
-   **打包工具**：`PyInstaller`（用于将程序打包为分发给最终用户的独立可执行文件`.exe`）。


---

### **6. 假设与依赖**

-   假设用户提供的考勤图片格式与示例图基本一致，排版规整。对于极度模糊或扭曲的图片，识别率会下降。
-   程序依赖本地的OCR引擎模型文件（如PaddleOCR的`inference`模型），首次运行或打包时需妥善处理。
-   程序运行需要用户电脑具备Python环境或直接运行打包后的可执行文件。

